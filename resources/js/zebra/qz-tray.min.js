/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/qz-tray@2.0.9-1/qz-tray.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var qz=function(){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var e={VERSION:"2.0.9",DEBUG:!1,log:{trace:function(){e.DEBUG&&console.log.apply(console,arguments)},info:function(){console.info.apply(console,arguments)},warn:function(){e.DEBUG&&console.warn.apply(console,arguments)},error:function(){console.error.apply(console,arguments)}},streams:{serial:"SERIAL",usb:"USB",hid:"HID"},websocket:{connection:null,connectConfig:{host:["localhost","localhost.qz.io"],hostIndex:0,usingSecure:!0,protocol:{secure:"wss://",insecure:"ws://"},port:{secure:[8181,8282,8383,8484],insecure:[8182,8283,8384,8485],portIndex:0},keepAlive:60,retries:0,delay:0},setup:{findConnection:function(t,o,n){if(t.port.secure.length)t.port.insecure.length||t.usingSecure||(e.log.trace("No insecure ports specified - forcing secure connection"),t.usingSecure=!0);else{if(!t.port.insecure.length)return void n(new Error("No ports have been specified to connect over"));t.usingSecure&&(e.log.error("No secure ports specified - forcing insecure connection"),t.usingSecure=!1)}var r,s=function(){if(t.port.portIndex++,t.usingSecure&&t.port.portIndex>=t.port.secure.length||!t.usingSecure&&t.port.portIndex>=t.port.insecure.length){if(t.hostIndex>=t.host.length-1)return void n(new Error("Unable to establish connection with QZ"));t.hostIndex++,t.port.portIndex=0}e.websocket.setup.findConnection(t,o,n)};r=t.usingSecure?t.protocol.secure+t.host[t.hostIndex]+":"+t.port.secure[t.port.portIndex]:t.protocol.insecure+t.host[t.hostIndex]+":"+t.port.insecure[t.port.portIndex];try{e.log.trace("Attempting connection",r),e.websocket.connection=new e.tools.ws(r)}catch(t){return e.log.error(t),void s()}null!=e.websocket.connection?(e.websocket.connection.established=!1,e.websocket.connection.onopen=function(s){if(!e.websocket.connection.established&&(e.log.trace(s),e.log.info("Established connection with QZ Tray on "+r),e.websocket.setup.openConnection({resolve:o,reject:n}),t.keepAlive>0))var i=setInterval(function(){qz.websocket.isActive()?e.websocket.connection.send("ping"):clearInterval(i)},1e3*t.keepAlive)},e.websocket.connection.onclose=function(){e.websocket.connection&&"undefined"!=typeof navigator&&-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&e.websocket.connection.onerror()},e.websocket.connection.onerror=function(t){e.log.trace(t),e.websocket.connection=null,s()}):n(new Error("Unable to create a websocket connection"))},openConnection:function(t){function o(o){void 0===o&&(o=null),e.websocket.connection.sendData({certificate:o,promise:t})}e.websocket.connection.established=!0,e.websocket.connection.onclose=function(t){for(var o in e.log.trace(t),e.log.info("Closed connection with QZ Tray"),null!=e.websocket.connection.promise&&e.websocket.connection.promise.resolve(),e.websocket.callClose(t),e.websocket.connection=null,e.websocket.pendingCalls)e.websocket.pendingCalls.hasOwnProperty(o)&&e.websocket.pendingCalls[o].reject(new Error("Connection closed before response received"))},e.websocket.connection.onerror=function(t){e.websocket.callError(t)},e.websocket.connection.sendData=function(t){e.log.trace("Preparing object for websocket",t),null==t.timestamp&&(t.timestamp=Date.now(),"number"!=typeof t.timestamp&&(t.timestamp=(new Date).getTime())),null!=t.promise&&(t.uid=e.websocket.setup.newUID(),e.websocket.pendingCalls[t.uid]=t.promise),t.position={x:screen?(screen.availWidth||screen.width)/2+(screen.left||screen.availLeft):0,y:screen?(screen.availHeight||screen.height)/2+(screen.top||screen.availTop):0};try{if(null!=t.call&&null==t.signature){var o={call:t.call,params:t.params,timestamp:t.timestamp},n=e.tools.hash(e.tools.stringify(o));n.then||(n=e.tools.promise(function(e){e(n)})),n.then(function(t){return e.security.callSign(t)}).then(function(o){e.log.trace("Signature for call",o),t.signature=o,e.signContent=void 0,e.websocket.connection.send(e.tools.stringify(t))})}else e.log.trace("Signature for call",t.signature),e.websocket.connection.send(e.tools.stringify(t))}catch(o){e.log.error(o),null!=t.promise&&(t.promise.reject(o),delete e.websocket.pendingCalls[t.uid])}},e.websocket.connection.onmessage=function(t){var o=JSON.parse(t.data);if(null!=o.uid){e.log.trace("Received response from websocket",o);var n=e.websocket.pendingCalls[o.uid];null==n?e.log.warn("No promise found for returned response"):null!=o.error?n.reject(new Error(o.error)):n.resolve(o.result),delete e.websocket.pendingCalls[o.uid]}else if(null==o.type)e.websocket.connection.close(4003,"Connected to incompatible QZ Tray version");else switch(o.type){case e.streams.serial:o.event||(o.event=JSON.stringify({portName:o.key,output:o.data})),e.serial.callSerial(JSON.parse(o.event));break;case e.streams.usb:o.event||(o.event=JSON.stringify({vendorId:o.key[0],productId:o.key[1],output:o.data})),e.usb.callUsb(JSON.parse(o.event));break;case e.streams.hid:e.hid.callHid(JSON.parse(o.event));break;default:e.log.warn("Cannot determine stream type for callback",o)}},e.security.callCert().then(o).catch(o)},newUID:function(){return(new Array(7).join("0")+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)}},dataPromise:function(t,o,n,r){return e.tools.promise(function(s,i){var c={call:t,promise:{resolve:s,reject:i},params:o,signature:n,timestamp:r};e.websocket.connection.sendData(c)})},pendingCalls:{},errorCallbacks:[],callError:function(t){if(Array.isArray(e.websocket.errorCallbacks))for(var o=0;o<e.websocket.errorCallbacks.length;o++)e.websocket.errorCallbacks[o](t);else e.websocket.errorCallbacks(t)},closedCallbacks:[],callClose:function(t){if(Array.isArray(e.websocket.closedCallbacks))for(var o=0;o<e.websocket.closedCallbacks.length;o++)e.websocket.closedCallbacks[o](t);else e.websocket.closedCallbacks(t)}},printing:{defaultConfig:{colorType:"color",copies:1,density:0,duplex:!1,fallbackDensity:null,interpolation:"bicubic",jobName:null,legacy:!1,margins:0,orientation:null,paperThickness:null,printerTray:null,rasterize:!0,rotation:0,scaleContent:!0,size:null,units:"in",altPrinting:!1,encoding:null,endOfDoc:null,perSpool:1}},serial:{serialCallbacks:[],callSerial:function(t){if(Array.isArray(e.serial.serialCallbacks))for(var o=0;o<e.serial.serialCallbacks.length;o++)e.serial.serialCallbacks[o](t);else e.serial.serialCallbacks(t)}},usb:{usbCallbacks:[],callUsb:function(t){if(Array.isArray(e.usb.usbCallbacks))for(var o=0;o<e.usb.usbCallbacks.length;o++)e.usb.usbCallbacks[o](t);else e.usb.usbCallbacks(t)}},hid:{hidCallbacks:[],callHid:function(t){if(Array.isArray(e.hid.hidCallbacks))for(var o=0;o<e.hid.hidCallbacks.length;o++)e.hid.hidCallbacks[o](t);else e.hid.hidCallbacks(t)}},security:{certPromise:function(e,t){t()},callCert:function(){return e.tools.promise(e.security.certPromise)},signaturePromise:function(){return function(e){e()}},callSign:function(t){return e.tools.promise(e.security.signaturePromise(t))}},tools:{promise:function(e){return new RSVP.Promise(e)},stringify:function(e){var t=Array.prototype.toJSON;delete Array.prototype.toJSON;var o=JSON.stringify(e);return t&&(Array.prototype.toJSON=t),o},hash:function(e){return Sha256.hash(e)},ws:"undefined"!=typeof WebSocket?WebSocket:null,absolute:function(e){if("undefined"!=typeof window&&"function"==typeof document.createElement){var t=document.createElement("a");return t.href=e,t.href}return e},extend:function(t){"object"!=typeof t&&(t={});for(var o=1;o<arguments.length;o++){var n=arguments[o];if(n)for(var r in n)if(n.hasOwnProperty(r)){if(t===n[r])continue;var s;if(n[r]&&n[r].constructor&&n[r].constructor===Object)s=Array.isArray(n[r])?t[r]||[]:t[r]||{},t[r]=e.tools.extend(s,n[r]);else void 0!==n[r]&&(t[r]=n[r])}}return t}}};function t(t,o){this.setPrinter=function(e){"string"==typeof e&&(e={name:e}),this.printer=e},this.getPrinter=function(){return this.printer},this.reconfigure=function(t){e.tools.extend(this.config,t)},this.getOptions=function(){return this.config},this.setPrinter(t),this.config=o}return t.prototype.print=function(e,t,o){qz.print(this,e,t,o)},{websocket:{isActive:function(){return null!=e.websocket.connection&&e.websocket.connection.established},connect:function(t){return e.tools.promise(function(o,n){if(qz.websocket.isActive())n(new Error("An open connection with QZ Tray already exists"));else if(null==e.websocket.connection)if(e.tools.ws)if(e.tools.ws.CLOSED&&2!=e.tools.ws.CLOSED){null==t&&(t={}),"undefined"!=typeof location&&"https:"===location.protocol||void 0===t.usingSecure&&(e.log.trace("Disabling secure ports due to insecure page"),t.usingSecure=!1),void 0===t.host||Array.isArray(t.host)||(t.host=[t.host]);var r=function(s){var i=!1,c=function(){i||(i=!0,t&&s<t.retries?r(s+1):n.apply(null,arguments))},a=function(){var n=e.tools.extend({},e.websocket.connectConfig,t);e.websocket.setup.findConnection(n,o,c)};0==s?a():setTimeout(a,1e3*t.delay)};r(0)}else n(new Error("Unsupported WebSocket version detected: HyBi-00/Hixie-76"));else n(new Error("WebSocket not supported by this browser"));else n(new Error("The current connection attempt has not returned yet"))})},disconnect:function(){return e.tools.promise(function(t,o){qz.websocket.isActive()?(e.websocket.connection.close(),e.websocket.connection.promise={resolve:t,reject:o}):o(new Error("No open connection with QZ Tray"))})},setErrorCallbacks:function(t){e.websocket.errorCallbacks=t},setClosedCallbacks:function(t){e.websocket.closedCallbacks=t},getNetworkInfo:function(t,o){return e.websocket.dataPromise("websocket.getNetworkInfo",{hostname:t,port:o})},getConnectionInfo:function(){if(e.websocket.connection){var t=e.websocket.connection.url.split(/[:\/]+/g);return{socket:t[0],host:t[1],port:+t[2]}}throw new Error("A connection to QZ has not been established yet")}},printers:{getDefault:function(){return e.websocket.dataPromise("printers.getDefault")},find:function(t){return e.websocket.dataPromise("printers.find",{query:t})}},configs:{setDefaults:function(t){e.tools.extend(e.printing.defaultConfig,t)},create:function(o,n){return new t(o,e.tools.extend({},e.printing.defaultConfig,n))}},print:function(t,o,n,r){for(var s=0;s<o.length;s++)o[s].constructor===Object&&((!o[s].format&&o[s].type&&"RAW"!==o[s].type.toUpperCase()&&"DIRECT"!==o[s].type.toUpperCase()||o[s].format&&("FILE"===o[s].format.toUpperCase()||"IMAGE"===o[s].format.toUpperCase()&&(0!==o[s].data.indexOf("data:image/")||0===o[s].data.indexOf(";base64,"))||"XML"===o[s].format.toUpperCase()))&&(o[s].data=e.tools.absolute(o[s].data)),o[s].options&&"string"==typeof o[s].options.overlay&&(o[s].options.overlay=e.tools.absolute(o[s].options.overlay)));var i={printer:t.getPrinter(),options:t.getOptions(),data:o};return e.websocket.dataPromise("print",i,n,r)},serial:{findPorts:function(){return e.websocket.dataPromise("serial.findPorts")},setSerialCallbacks:function(t){e.serial.serialCallbacks=t},openPort:function(t,o){var n={port:t,options:o};return e.websocket.dataPromise("serial.openPort",n)},sendData:function(t,o,n){null!=n&&e.log.warn("Properties object is deprecated on sendData calls, use openPort instead.");var r={port:t,data:o,properties:n};return e.websocket.dataPromise("serial.sendData",r)},closePort:function(t){return e.websocket.dataPromise("serial.closePort",{port:t})}},usb:{listDevices:function(t){return e.websocket.dataPromise("usb.listDevices",{includeHubs:t})},listInterfaces:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.listInterfaces",t)},listEndpoints:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],interface:arguments[2]}),e.websocket.dataPromise("usb.listEndpoints",t)},setUsbCallbacks:function(t){e.usb.usbCallbacks=t},claimDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],interface:arguments[2]}),e.websocket.dataPromise("usb.claimDevice",t)},isClaimed:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.isClaimed",t)},sendData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],data:arguments[3]}),e.websocket.dataPromise("usb.sendData",t)},readData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],responseSize:arguments[3]}),e.websocket.dataPromise("usb.readData",t)},openStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],responseSize:arguments[3],interval:arguments[4]}),e.websocket.dataPromise("usb.openStream",t)},closeStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2]}),e.websocket.dataPromise("usb.closeStream",t)},releaseDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.releaseDevice",t)}},hid:{listDevices:function(){return e.websocket.dataPromise("hid.listDevices")},startListening:function(){return e.websocket.dataPromise("hid.startListening")},stopListening:function(){return e.websocket.dataPromise("hid.stopListening")},setHidCallbacks:function(t){e.hid.hidCallbacks=t},claimDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.claimDevice",t)},isClaimed:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.isClaimed",t)},sendData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],data:arguments[2],endpoint:arguments[3]}),e.websocket.dataPromise("hid.sendData",t)},readData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],responseSize:arguments[2]}),e.websocket.dataPromise("hid.readData",t)},openStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],responseSize:arguments[2],interval:arguments[3]}),e.websocket.dataPromise("hid.openStream",t)},closeStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.closeStream",t)},releaseDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.releaseDevice",t)}},security:{setCertificatePromise:function(t){e.security.certPromise=t},setSignaturePromise:function(t){e.security.signaturePromise=t}},api:{showDebug:function(t){e.DEBUG=t},getVersion:function(){return e.websocket.dataPromise("getVersion")},setPromiseType:function(t){e.tools.promise=t},setSha256Type:function(t){e.tools.hash=t},setWebSocketType:function(t){e.tools.ws=t}},version:e.VERSION}}();!function(){if("function"==typeof define&&define.amd)define(qz);else if("object"==typeof exports){module.exports=qz;try{var e=require("crypto");qz.api.setSha256Type(function(t){return e.createHash("sha256").update(t).digest("hex")})}catch(e){}}else window.qz=qz}();
//# sourceMappingURL=/sm/16b20428e54989697cfbfa58c0c6964e4ab7cb862ca099b1d66744905a246b26.map